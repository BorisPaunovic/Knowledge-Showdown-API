import{_ as D,r,x as M,o as P,a as b,w as A,v as I,b as y,c as C,d as e,y as j,m as u,t as $,f as W,C as z,p as F,j as L,V as S,L as T,P as O,h as q,n as x,T as G,F as Q,e as Y,g as H,q as J,s as K}from"./index-a84fb00c.js";import{A as w,S as X}from"./SearchComp-7673306b.js";const N=l=>(F("data-v-9468bea1"),l=l(),L(),l),Z={class:"modal"},ee={class:"addNewCategory"},te=N(()=>e("h1",null,"Add New Category",-1)),ae=["onSubmit"],se={class:"addNewCategoryForm"},oe=N(()=>e("span",{class:"imgTitle"},"Category Picture",-1)),ne=N(()=>e("span",null," ",-1)),ie={class:"imgError"},le=N(()=>e("button",{class:"btn-base",type:"submit"},"Submit",-1)),re={__name:"AddCategoryModal",props:["addCatModalVisibility"],emits:["close","newCategoryAdded"],setup(l,{emit:p}){const h=r([]),n=r({cat_name:"",cat_description:"",file:null}),a=r({cat_name:"",cat_description:"",file:null});let _=!1,c=r();async function f(){if(a.value.cat_name||a.value.cat_description||_===!1)return alert("Please finish the form");try{let t=new FormData;t.append("cat_name",n.value.cat_name.trim()),t.append("cat_description",n.value.cat_description.trim()),t.append("file",n.value.file);const s=await w.addNewCategory(t);alert("You've successfuly added new category"),p("close"),p("newCategoryAdded"),n.value.cat_name="",n.value.cat_description="",n.value.file=null}catch(t){if(console.log(t),t.response){if(t.response.status===500)return alert("Internal server error");if(t.response.status===400)return alert("Bad request, invalid parameters")}}}function k(){p("close")}async function V(){try{const t=await z.getAllCategories();h.value=t.data.categories}catch(t){console.error(t.message)}}M(()=>n.value.cat_name,t=>{t&&(a.value.cat_name=S.cat_name(t))}),M(()=>n.value.cat_description,t=>{t&&(a.value.cat_description=S.cat_description(t))});function v(t){let s=t.target.files[0];if(s){if(s.name.toLowerCase().endsWith(".png")||s.name.toLowerCase().endsWith(".jpg")||s.name.toLowerCase().endsWith(".jpeg"))_=!0,a.value.file=t.target.files[0],n.value.file=t.target.files[0];else return c.value="Can only accept .png, .jpg, .jpeg files";return""}else return c.value="Empty image"}return P(()=>{V()}),(t,s)=>{const i=b("BaseInput"),o=b("BaseTextarea");return A((y(),C("div",Z,[e("div",ee,[e("div",{class:"registerTitle"},[e("span",{class:"close",onClick:k}," ×"),te]),e("form",{onSubmit:j(f,["prevent"]),enctype:"multipart/form-data"},[e("div",se,[u(i,{modelValue:n.value.cat_name,"onUpdate:modelValue":s[0]||(s[0]=d=>n.value.cat_name=d),label:"Category Name",type:"text",error:a.value.cat_name,required:""},null,8,["modelValue","error"]),u(o,{modelValue:n.value.cat_description,"onUpdate:modelValue":s[1]||(s[1]=d=>n.value.cat_description=d),label:"Category Description",type:"text",required:"",error:a.value.cat_description},null,8,["modelValue","error"]),e("div",null,[e("div",null,[e("div",null,[oe,ne,e("span",ie,$(W(c)),1)]),e("input",{type:"file",ref:"fileInput",onChange:v},null,544)])])]),le],40,ae)])],512)),[[I,l.addCatModalVisibility]])}}},ce=D(re,[["__scopeId","data-v-9468bea1"]]);const B=l=>(F("data-v-68c21023"),l=l(),L(),l),de={class:"modal"},ue={class:"addNewCategory"},_e=B(()=>e("h1",null,"Edit Category",-1)),pe=["onSubmit"],me={class:"addNewCategoryForm"},ge=B(()=>e("span",{class:"imgTitle"},"Category Picture",-1)),he=B(()=>e("span",null," ",-1)),ve={class:"imgError"},ye=B(()=>e("button",{class:"btn-base",type:"submit"},"Submit",-1)),fe={__name:"EditCategoryModal",props:["editCatModalVisibility","category_id"],emits:["close","categoryEdited"],setup(l,{emit:p}){const h=l,n=r(""),a=r({});let _=r();const c=r({cat_name:"",cat_description:"",file:null});async function f(){if(c.value.cat_name||c.value.cat_description)return alert("Please finish the form");try{let t=new FormData;t.append("cat_name",a.value.cat_name.trim()),t.append("cat_description",a.value.cat_description.trim()),t.append("file",a.value.cat_img),t.append("cat_id",a.value.cat_id);const s=await w.editCategory(t);p("categoryEdited"),p("close")}catch(t){console.log(t)}}async function k(){try{const t=await w.getCategoryForEdit(h.category_id);n.value=t.data.category[0]}catch(t){console.error(t.message)}}function V(){p("close")}M(()=>a.value.cat_name,t=>{t&&(c.value.cat_name=S.cat_name(t))}),M(()=>a.value.cat_description,t=>{t&&(c.value.cat_description=S.cat_description(t))});function v(t){let s=t.target.files[0];if(s){if(s.name.toLowerCase().endsWith(".png")||s.name.toLowerCase().endsWith(".jpg")||s.name.toLowerCase().endsWith(".jpeg"))c.value.cat_img=t.target.files[0],a.value.cat_img=t.target.files[0];else return _.value="Can only accept .png, .jpg, .jpeg files";return""}else return _.value="Empty image"}return P(async()=>{await k(),a.value={cat_name:n.value.cat_name,cat_description:n.value.cat_description,cat_id:n.value.cat_id,cat_img:n.value.cat_img}}),(t,s)=>{const i=b("BaseInput"),o=b("BaseTextarea");return A((y(),C("div",de,[e("div",ue,[e("div",{class:"registerTitle"},[e("span",{class:"close",onClick:V}," ×"),_e]),e("form",{onSubmit:j(f,["prevent"])},[e("div",me,[u(i,{modelValue:a.value.cat_name,"onUpdate:modelValue":s[0]||(s[0]=d=>a.value.cat_name=d),label:"Category Name",type:"text",error:c.value.cat_name,required:""},null,8,["modelValue","error"]),u(o,{modelValue:a.value.cat_description,"onUpdate:modelValue":s[1]||(s[1]=d=>a.value.cat_description=d),label:"Category Description",type:"text",required:"",error:c.value.cat_description},null,8,["modelValue","error"]),e("div",null,[e("div",null,[e("div",null,[ge,he,e("span",ve,$(W(_)),1)]),e("input",{type:"file",ref:"fileInput",onChange:v},null,544)])])]),ye],40,pe)])],512)),[[I,l.editCatModalVisibility]])}}},Ce=D(fe,[["__scopeId","data-v-68c21023"]]);const g=l=>(F("data-v-8b7ea143"),l=l(),L(),l),we={class:"admin-wrapper"},be={class:"mainAdmin"},ke={class:"back"},Ve={class:"title"},$e=g(()=>e("h1",null,"Admin Panel - All Categories",-1)),Ee={key:0},xe={key:1},Me={class:"guide"},Ae=g(()=>e("h3",null,"Adding a New Category",-1)),Ie=g(()=>e("ul",null,[e("li",null,"Click 'Add Category' at the top."),e("li",null,"Enter the new category name and description."),e("li",null,"Click 'Save'.")],-1)),Se=g(()=>e("h3",null,"Editing Categories",-1)),Ne=g(()=>e("ul",null,[e("li",null,"Click 'Edit' next to the category you want to change."),e("li",null,"Modify the name and/or description."),e("li",null,"Click 'Update' to apply changes.")],-1)),Be=g(()=>e("h3",null,"Deleting Categories",-1)),De=g(()=>e("ul",null,[e("li",null,"Press 'Delete' for the unwanted category."),e("li",null,"Confirm the deletion.")],-1)),Pe={class:"searchResults"},Fe=g(()=>e("tr",null,[e("th"),e("th",null,"Name"),e("th",{class:"hidden unhidden"},"Description"),e("th",null,"Image"),e("th",null,"Deleted"),e("th",null,"Edit")],-1)),Le={style:{"white-space":"nowrap"}},Te={class:"hidden unhidden"},qe=["src"],je={class:"center small-width"},We={class:"switch"},Ue=["checked","onChange","id"],Re=g(()=>e("span",{class:"slider"},null,-1)),ze={class:"small-width"},Oe={key:1},Ge=g(()=>e("td",{colspan:"5"}," Oops! We couldn't find any results for that term. Please try a different keyword or phrase. ",-1)),Qe=[Ge],Ye=5,He={__name:"CategoriesView",setup(l){const p=r(!1);T.getUser().rol_name,T.id();const h=r([]),n=r("Type in to search..."),a=r(!1),_=r(!1),c=r(""),f=r(!1);async function k(i){if(i.trim().length<1){v();return}try{const o=await w.searchCategories(i.trim());h.value=o.data.searchDB}catch(o){console.error(o.message)}}async function V(i){c.value=i,_.value=!0}async function v(){try{try{s()}catch{}const i=await w.getAllCategories();h.value=i.data.categories}catch(i){console.error(i.message)}}async function t(i){try{const o=await w.switchDeleteCat(i);v()}catch(o){console.error(o)}}function s(){let i=document.getElementById("catImage123"),o=i.src;i.src="",i.src=o}return P(async()=>{await v(),p.value=O.checkPermission(Ye)}),(i,o)=>{const d=b("font-awesome-icon"),U=b("RouterLink");return y(),C("div",we,[e("div",be,[A(e("div",ke,[u(U,{to:{name:"admin"}},{default:q(()=>[u(d,{icon:["fas","arrow-left-long"],style:{color:"#ffffff"}})]),_:1})],512),[[I,p.value]]),e("div",Ve,[$e,e("div",{class:"add-new",title:"Add New Category",onClick:o[0]||(o[0]=m=>a.value=!0)}," + ")]),e("h2",{onClick:o[1]||(o[1]=m=>f.value=!f.value)},[x(" Quick Guide for Category Management "),f.value===!1?(y(),C("span",Ee,[x(" (click to unhide) "),u(d,{icon:["far","eye"]})])):(y(),C("span",xe,[x(" (click to hide) "),u(d,{icon:["far","eye-slash"]})]))]),u(G,{name:"fade"},{default:q(()=>[A(e("div",Me,[Ae,Ie,Se,Ne,Be,De,x(" Please Note: Deleting a category is permanent and removes it from user options. Ensure that no active quizzes require the category before deletion. ")],512),[[I,f.value]])]),_:1})]),u(X,{onSearchTerm:k,placeholder:n.value},null,8,["placeholder"]),e("div",Pe,[e("table",null,[Fe,h.value.length?(y(!0),C(Q,{key:0},Y(h.value,(m,E)=>(y(),C("tr",{key:E,class:K({grey:E%2})},[e("td",Le,$(E+1)+".",1),e("td",null,$(m.cat_name),1),e("td",Te,$(m.cat_description),1),e("td",null,[e("div",null,[e("img",{class:"catImg",id:"catImage123",src:m.cat_img},null,8,qe)])]),e("td",je,[e("label",We,[e("input",{checked:m.cat_is_deleted!==null,onChange:R=>t(m.cat_id),type:"checkbox",id:h.value.length+E},null,40,Ue),Re])]),e("td",ze,[u(d,{icon:["fas","pen-to-square"],size:"2xl",onClick:R=>V(m.cat_id),class:"editBtn"},null,8,["onClick"])])],2))),128)):(y(),C("tr",Oe,Qe))]),u(ce,{addCatModalVisibility:a.value,onClose:o[2]||(o[2]=m=>a.value=!1),onNewCategoryAdded:v},null,8,["addCatModalVisibility"]),_.value?(y(),H(Ce,{key:0,editCatModalVisibility:_.value,onClose:o[3]||(o[3]=m=>_.value=!1),onCategoryEdited:v,category_id:c.value},null,8,["editCatModalVisibility","category_id"])):J("",!0)])])}}},Xe=D(He,[["__scopeId","data-v-8b7ea143"]]);export{Xe as default};
